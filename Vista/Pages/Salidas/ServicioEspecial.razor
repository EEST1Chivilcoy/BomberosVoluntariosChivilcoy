@page "/fire-force/salidas/servicio-especial/{TipoServicioEspecial:int}"
@page "/fire-force/salidas/servicio-especial/{TipoServicioEspecial:int}/{AnioSalida:int}/{NumeroSalida:int}"
@using Vista.Data.ViewModels.Personal;
@using Vista.Data.ViewModels.Servicios;
@using Vista.Data.Enums.Salidas;

@*Servicios Utilizados*@
@using Vista.Services
@inject ISalidaService SalidaService
@inject IBomberoService BomberoService
@inject IVehiculoSalidaService VehiculoSalidaService
@inject IFuerzaIntervinienteService FuerzaIntervinienteService
@inject IMessageService message
@inject NavigationManager navigationManager

@*Componentes Generales*@
@using Vista.Components.Forms.Salidas.General;
@using Vista.Data.Models.Salidas.Componentes;
@using Vista.Components.Forms.Salidas;
@using Vista.Components.Forms.Salidas.General;
@using Vista.Data.Models.Salidas.Planillas.Servicios;
<Form Model="@ServicioEspecialViewModel"
      LabelColSpan="8"
      WrapperColSpan="16"
      OnFinish="OnFinish"
      OnFinishFailed="OnFinishFailed"
      Style="width: 100%; height: 100%; overflow: auto;">

    <div style="max-width: 1800px; margin: 0 auto; padding: 2rem 1rem;">

        <!-- Encabezado -->
        <div style="text-align: center; margin-bottom: 3rem; padding-bottom: 1rem; border-bottom: 2px solid #f0f0f0;">
            <h1 style="margin: 0; color: #1890ff; font-size: 2.5rem; font-weight: 600;">
                SERVICIO ESPECIAL
            </h1>
            <p style="margin: 0.5rem 0 0 0; color: #666; font-size: 1.1rem;">
                Complete todos los campos requeridos para registrar la salida
            </p>
        </div>

        <!-- Tabs container -->
        <Tabs DefaultActiveKey="1" Class="custom-tabs" Style="box-shadow: 0 4px 16px rgba(24,144,255,0.08); border-radius: 12px;">
            <TabPane Key="1" Tab="📋 Datos-Generales" Class="tab-general">
                <DatosGenerales Model="@ServicioEspecialViewModel" OnCompleted="@((bool done) => _parte1Completa = done)" />
            </TabPane>

            <TabPane Key="2" Tab="📞 Datos Telefónicos">
                <Participantes Model="@ServicioEspecialViewModel"
                               OnCompleted="@((bool done) => _parte2Completa = done)" />
            </TabPane>

            <TabPane Key="3" Tab="🛡️ Fuerzas Intervinientes" Disabled="@(ServicioEspecialViewModel.FuerzasIntervinientesParticipantes?.Any() != true)">
                <FuerzasIntervinientes Model="@ServicioEspecialViewModel" />
            </TabPane>

            <TabPane Key="4" Tab="⚠️ Afectados">
                <Damnificados Model="@ServicioEspecialViewModel" />
                <VehiculosAfectados Model="@ServicioEspecialViewModel" />
            </TabPane>

            <TabPane Key="5" Tab="🚒 Unidades">
                <Vehiculos Model="@ServicioEspecialViewModel" BomberosTodos="@BomberosTodos" Flota="@MovilesTodos" />
            </TabPane>

            <TabPane Key="6" Tab="🪪 Personal">
                <Personal Model="@ServicioEspecialViewModel" BomberosTodos="@BomberosTodos" />
            </TabPane>

            <TabPane Key="7" Tab="🛠️ Tipo de Servicio">
                <TipoDeServicio Model="@ServicioEspecialViewModel" isUnlocked="true" OnCompleted="@((bool done) => {/* noop */})" />
                <div class="submit-section-firmas">
                    <FormItem WrapperColSpan="24" Style="margin: 0;">
                        <Button HtmlType="submit" Size="ButtonSize.Large" class="submit-button-firmas">
                            <Icon Type="printer" Style="margin-right: 0.5rem;" />
                            Imprimir Salida
                        </Button>
                    </FormItem>
                </div>
            </TabPane>

        </Tabs>

        @if (_visible1 == true)
        {
            <ImprimirModal AnioNumeroParte="@ImprimirAnio" NumeroParte="@ImprimirNumeroParte" />
        }
    </div>
</Form>

<style>


    .custom-tabs .ant-tabs-nav {
        border-bottom: none !important;
        margin-bottom: 1.5rem !important;
        display: flex;
        justify-content: center;
    }


    .custom-tabs .ant-tabs-tab {
        background: #f9f9f9;
        border-radius: 8px 8px 0 0;
        margin: 0 0.25rem;
        padding: 0.5rem 1.25rem;
        font-weight: 600;
        color: #555;
        transition: all 0.25s ease;
    }


        .custom-tabs .ant-tabs-tab:hover {
            background: #e6f7ff;
            color: #1890ff;
            cursor: pointer;
        }

    .custom-tabs .ant-tabs-tab-active {
        background: white;
        color: #1890ff !important;
        box-shadow: 0 -2px 8px rgba(0,0,0,0.08);
        border: 1px solid #e6f7ff;
        border-bottom: none;
        z-index: 1;
        position: relative;
    }

        .custom-tabs .ant-tabs-tab-active .ant-tabs-tab-btn {
            font-weight: 700;
        }

    .submit-section-firmas {
        background: linear-gradient(135deg, #1890ff 0%, #096dd9 100%);
        border-radius: 12px;
        padding: 2rem;
        text-align: center;
        margin-top: 1rem;
    }

    .submit-button-firmas {
        background: white !important;
        color: #1890ff !important;
        border: none !important;
        font-weight: 600 !important;
        padding: 0.75rem 3rem !important;
        height: auto !important;
        font-size: 1.1rem !important;
        border-radius: 8px !important;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15) !important;
        transition: all 0.3s ease !important;
    }

        .submit-button-firmas:hover {
            transform: translateY(-2px) !important;
            box-shadow: 0 8px 20px rgba(0,0,0,0.2) !important;
        }

</style>